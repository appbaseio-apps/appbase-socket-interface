<!doctype html>
<html>
  <head>
    <title>Appbase.io + Socket.io</title>
    <style>
	#header {
		background-color:black;
		color:white;
		text-align:center;
		padding:5px;
	}
	#nav {
		line-height:30px;
		background-color:#eeeeee;
		height:300px;
		width:100px;
		float:left;
		padding:5px;	      
	}
	#section {
		width:350px;
		float:left;
		padding:10px;	 	 
	}
	#footer {
		background-color:#eeeeee;
		color:white;
		clear:both;
		text-align:center;
	   padding:5px;	 	 
	}

	body { font: 13px Helvetica, Arial; }
	form input { border: 1; padding: 10px; width: 90%; margin-bottom: .5%; }
	form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
	#messages { list-style-type: none; margin: 0; padding: 0; }
	#messages li { padding: 5px 10px; }
	#messages li:nth-child(odd) { background: #eee; }
	
	
	#wrap {
		width:350px;
		margin:0 auto;
	}
	
	#left_col {
		float:left;
		width:125px;
	}
	#right_col {
		float:right;
		width:125px;
	}
    </style>

  </head>
  <body>

	<div id="header">
		<h1>Appbase.io + Socket.io</h1>
	</div>

	<div id="nav">
		<p id="subcount"></p>
		<button id="subscribe_approved">Subscribe to Approved Post</button>
		<p/>
		<p id="subcount_admin"></p>
		<button id="subscribe_pending">Subscribe to Pending Post</button>
	</div>

	<div id="section">
		<div id="wrap">
			<div id="left_col" style="border: 1px solid black">
				User Dashboard<p/>
				<ul id="posts" style="border: 1px solid black" width="auto"></ul>
			</div>
			<div id="right_col" style="border: 1px solid black">
				Admin Dashboard<p/>
				<ul id="pending_posts" style="border: 1px solid black"></ul>
			</div>
		</div>
	</div>

	<div id="footer">
		<form action="">
			<select name="role" style="background-color:#ff0000;">
				<option value="guest">guest</option>
				<option value="user">user</option>
				<option value="admin">admin</option>
			</select>
			<br/>
			<br/>
			Title:<br/>
			<input id="title" autocomplete="off" /> <br/>
			Body:<br/>
			<input id="post" autocomplete="off" />
			<button>Send</button>
		</form>
	</div>


    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      var socket = io();

      $('form').submit(function(){
		var jsonObject = {
				"role":$("select option:selected").text(),
				"title":$('#title').val(),
				"post":$('#post').val()
			};

        socket.emit('blog post', jsonObject);
        $('#title').val('');
        $('#post').val('');
        return false;
      });

	  $("#subscribe_approved").click(function() {
		var jsonObject = {
			"role":$("select option:selected").text()
		};
			
        socket.emit('subscribe_approved', jsonObject);
	  });
	  
	  $("#subscribe_pending").click(function(){
		var jsonObject = {
			"role":$("select option:selected").text()
		};
		socket.emit('subscribe_pending', jsonObject);
	  });

      socket.on('blog post', function(msg){
        $('#posts').append($('<li>').text(msg.post));
      });

	  socket.on('subscribecount', function(msg){
		$('#subcount').text(msg);
	  });
	  
	  socket.on('failure', function(msg){
		alert(msg);
	  });
	  
	  socket.on('success', function(msg){
		alert(msg);
	  });
    </script>
  </body>
</html>
